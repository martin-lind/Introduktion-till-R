<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Läsa in data i R – Introduktion till R</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-5b4ad623e5705c0698d39aec6f10cf02.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    </a>
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Introduktion till R</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Hem</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../tutorials/index.html"> 
<span class="menu-text">Tutorials</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">Om hemsidan</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#vilket-sätt-skall-en-fil-läsas-in-på" id="toc-vilket-sätt-skall-en-fil-läsas-in-på" class="nav-link active" data-scroll-target="#vilket-sätt-skall-en-fil-läsas-in-på">Vilket sätt skall en fil läsas in på?</a></li>
  <li><a href="#relativ-sökväg-till-filen" id="toc-relativ-sökväg-till-filen" class="nav-link" data-scroll-target="#relativ-sökväg-till-filen">Relativ sökväg till filen</a>
  <ul class="collapse">
  <li><a href="#var-är-jag" id="toc-var-är-jag" class="nav-link" data-scroll-target="#var-är-jag">Var är jag?</a></li>
  <li><a href="#ändra-din-working-directory" id="toc-ändra-din-working-directory" class="nav-link" data-scroll-target="#ändra-din-working-directory">Ändra din Working Directory</a></li>
  <li><a href="#läs-in-filen" id="toc-läs-in-filen" class="nav-link" data-scroll-target="#läs-in-filen">Läs in filen</a></li>
  </ul></li>
  <li><a href="#inspektera-ditt-data" id="toc-inspektera-ditt-data" class="nav-link" data-scroll-target="#inspektera-ditt-data">Inspektera ditt data</a></li>
  <li><a href="#absolut-sökväg-till-filen" id="toc-absolut-sökväg-till-filen" class="nav-link" data-scroll-target="#absolut-sökväg-till-filen">Absolut sökväg till filen</a>
  <ul class="collapse">
  <li><a href="#ta-reda-på-den-absoluta-sökvägen-till-din-fil-med-data" id="toc-ta-reda-på-den-absoluta-sökvägen-till-din-fil-med-data" class="nav-link" data-scroll-target="#ta-reda-på-den-absoluta-sökvägen-till-din-fil-med-data">Ta reda på den absoluta sökvägen till din fil med data</a></li>
  <li><a href="#läs-in-filen-i-r" id="toc-läs-in-filen-i-r" class="nav-link" data-scroll-target="#läs-in-filen-i-r">Läs in filen i R</a></li>
  </ul></li>
  <li><a href="#dataformat" id="toc-dataformat" class="nav-link" data-scroll-target="#dataformat">Dataformat</a></li>
  <li><a href="#läsa-in-csv-fil" id="toc-läsa-in-csv-fil" class="nav-link" data-scroll-target="#läsa-in-csv-fil">Läsa in csv-fil</a>
  <ul class="collapse">
  <li><a href="#läs-in-filen-1" id="toc-läs-in-filen-1" class="nav-link" data-scroll-target="#läs-in-filen-1">Läs in filen</a></li>
  </ul></li>
  <li><a href="#läsa-in-excelfil" id="toc-läsa-in-excelfil" class="nav-link" data-scroll-target="#läsa-in-excelfil">Läsa in Excelfil</a>
  <ul class="collapse">
  <li><a href="#läsa-in-excelfilen" id="toc-läsa-in-excelfilen" class="nav-link" data-scroll-target="#läsa-in-excelfilen">Läsa in Excelfilen</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Läsa in data i R</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Det första steget, innan man gör en statistisk analys, är alltid att läsa in data i R.</p>
<p>Vi kommer att gå igen följande:</p>
<ol type="1">
<li><p>Hur man läser in datafiler i R</p></li>
<li><p>Översikt över vanliga filtyper som R kan läsa in, vilket är beskrivet i delen om <a href="#dataformat">Dataformat</a></p></li>
</ol>
<section id="vilket-sätt-skall-en-fil-läsas-in-på" class="level2">
<h2 class="anchored" data-anchor-id="vilket-sätt-skall-en-fil-läsas-in-på">Vilket sätt skall en fil läsas in på?</h2>
<p>Det finns många sätt att läsa in en fil, det beror dels på om du använder R eller R Studio, men också på om du vill dokumentera vad filen heter och var den är placerad (rekommenderas för reproducerbarhet). Slutligen kan valet bero på om du använder R-projekt eller inte.</p>
<p>Nedan kommer vi gå igen följande metoder:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Metod</th>
<th>Beskrivning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="#relativ-sökväg-till-filen">Relativ sökväg till filen</a></td>
<td>Du anger först vilken mapp din fil ligger i (din Working Directory) och sedan vad filen heter</td>
</tr>
<tr class="even">
<td><a href="#absolut-sökväg-till-filen">Absolut sökväg till filen</a></td>
<td>Du anger exakt var filen ligger på din hårddisk och vad den heter</td>
</tr>
</tbody>
</table>
<p>Vilken metod man använder är en smaksak, båda metoderna är vanliga och man bör känna till båda.</p>
</section>
<section id="relativ-sökväg-till-filen" class="level2">
<h2 class="anchored" data-anchor-id="relativ-sökväg-till-filen">Relativ sökväg till filen</h2>
<p>Med relativ sökväg menas att du först anger vilken mapp filen ligger i, och sedan vad filen heter.</p>
<p>Ladda ner följande fil <a href="data/testdata_v2.txt">testdata_v2.txt</a> (högerklicka, välj “spara länk som”) och spara filen på din hårddisk i en mapp med ett lämpligt namn.</p>
<p>Nästa steg är att tala om för R var på din hårddisk du har sparat filen, dvs vad som är sökvägen till mappen som filen ligger i. Sedan kan du tala om för R vilken fil i mappen du skall läsa in.</p>
<section id="var-är-jag" class="level3">
<h3 class="anchored" data-anchor-id="var-är-jag">Var är jag?</h3>
<p>Platsen du befinner dig just nu är din Working Direcory, och du kan själv bestämma vad som är din Working Directory. Troligtvis har du alla filer som tillhör ett visst projekt i en mapp på din hårddisk, då hade det varit smart att ange den mappen som din Working Directory.</p>
<p>Du kan se var din Working Directory är just nu genom funktionen <code>getwd()</code></p>
<p>Testa att undersöka var din Working Directory är</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">getwd</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "/Users/martin/git_projects/Introduktion-till-R/tutorials/read-data"</code></pre>
</div>
</div>
</section>
<section id="ändra-din-working-directory" class="level3">
<h3 class="anchored" data-anchor-id="ändra-din-working-directory">Ändra din Working Directory</h3>
<p>Ett enkelt sätt att ändra din Working Directory är att använda dig av menyerna.</p>
<p>Använd menyerna för att välja mappen där du sparat filen <code>testdata.txt</code> som din nya Working Directory!</p>
<p>I <strong>R</strong> kan du välja Working Directory genom att klicka följande i menyerna:</p>
<p><img src="images/R-setwd.png" class="img-fluid" width="600"></p>
<p>I <strong>RStudio</strong> finns motsvarande menyval</p>
<p><img src="images/RStudio-setwd.png" class="img-fluid" width="600"></p>
<p>Nu har du ställt in din Working Directory så att det är den mappen som filerna du vill arbeta med ligger i!</p>
<p>Det är dock bra att dokumentera din Working Directory i ditt script, så att du inte behöver sätta den manuellt i menyerna nästa gång du skall arbeta med samma data. Det gör också att du minns var filerna ligger.</p>
<p><strong>Efter att du ställt in rätt Working Directory i menyerna, gör följande:</strong></p>
<ol type="1">
<li>Ta du reda på den absoluta sökvägen till din Working Directory med <code>getwd()</code></li>
</ol>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">getwd</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "/Users/martin/git_projects/Introduktion-till-R/tutorials/read-data"</code></pre>
</div>
</div>
<ol start="2" type="1">
<li>Skriv in den absoluta sökvägen i ditt script, inuti funktionen <code>setwd()</code></li>
</ol>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">"/Users/martin/git_projects/Introduktion-till-R"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>Nästa gång du öppnar R och ditt script så räcker det att köra raden med <code>setwd()</code> där du just fyllt i din sökväg till din Working Directory, så hamnar du direkt i din mapp och kan läsa in dina filer!</p>
</section>
<section id="läs-in-filen" class="level3">
<h3 class="anchored" data-anchor-id="läs-in-filen">Läs in filen</h3>
<p>Nu är din Working Directory samma mapp som filen <code>testdata.txt</code> ligger i.</p>
<p>Vi kommer att läsa in filen med funktionen <code>read.table()</code>.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>testdata <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">"testdata_v2.txt"</span>,</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">header=</span>T,</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>,</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">dec=</span><span class="st">","</span>) </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p><code>&lt;-</code> betyder att vi sparar resultatet av funktionen (just nu <code>read.table()</code>) i ett objekt. Eftersom det är vårt data är objektet en <strong>dataframe</strong>. Pilen <code>&lt;-</code> pekar på objektet, och vi ger det ett passande namn, i det här fallet <code>testdata</code>.</p>
<p><code>read.table()</code> är funktionen för att läsa in textfiler med filändelsen <code>.txt</code></p>
<p><code>"testdata_v2.txt"</code> är sökvägen till datafilen, och eftersom den ligger direkt i din Working Directiory behöver vi bara skriva ut namnet på filen (<code>testdata_v2.txt</code>).</p>
<p><code>header=T</code> betyder att den första raden i datafilen är en rubrikrad och inte består av data. Det är nästan alltid fallet om du läser in en datafil till R. Om även första raden består av data (dvs det finns inga rubriker) ersätter du <code>T</code> med <code>F</code> (<code>T</code> står för TRUE, <code>F</code> står för FALSE).</p>
<p><code>sep=T</code> betyder att alla värden/celler är separerade med TAB (det är en tab-separerad textfil).</p>
<p><code>dec=","</code> betyder att kommatecken används som decimalseparator (ex 1,32). Om filen istället använder punkt som decimalseparator (ex 1.32), anger du istället <code>dec="."</code></p>
</section>
</section>
<section id="inspektera-ditt-data" class="level2">
<h2 class="anchored" data-anchor-id="inspektera-ditt-data">Inspektera ditt data</h2>
<p>Nästa steg är att insprektera ditt dataset, för att se om allt gått rätt till vid inläsningen.</p>
<p>Börja med att inspektera datasetets struktur med <code>str()</code>.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(testdata)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   10 obs. of  3 variables:
 $ Colour: chr  "Green" "Green" "Green" "Green" ...
 $ Weight: int  4 3 5 4 5 12 14 15 11 14
 $ Length: num  1.3 1.1 3.4 2.5 7.1 14.5 16.9 13.5 9.4 11</code></pre>
</div>
</div>
<p><code>$ Colour: chr</code> betyder att värderna i <code>Colour</code> kolumnen är <em>bokstäver</em> (characters)</p>
<p><code>$ Weight: int</code> betyder att värderna i kolumnen <code>Weight</code> är <em>heltal</em> (integers)</p>
<p><code>$ Length: num</code> betyder att värderna i kolumnen <code>Length</code> är <em>decimaltal</em> (numeric)</p>
<p>Om du har en kolumn som borde innehålla decimaltal, skall det stå <code>num</code>. Om det istället står <code>chr</code> betyder det att datafilen har punkt som decimalavskiljare, men du utgår från att det är komma (eller tvärtom) och därmed tror R att det är text. Ändra avskiljare, ex från <code>dec=","</code> till <code>dec="."</code> i koden och importera datasetet på nytt.</p>
<p>Sedan visar du de första raderna i ditt dataset med funktionen <code>head()</code> och verifierar att allt ser korrekt ut.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(testdata)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  Colour Weight Length
1  Green      4    1.3
2  Green      3    1.1
3  Green      5    3.4
4  Green      4    2.5
5  Green      5    7.1
6   Blue     12   14.5</code></pre>
</div>
</div>
<p>Om allt ser korrekt ut så är du redo att analysera ditt data!</p>
</section>
<section id="absolut-sökväg-till-filen" class="level2" data-link="Absolut sökväg till filen">
<h2 data-link="Absolut sökväg till filen" class="anchored" data-anchor-id="absolut-sökväg-till-filen">Absolut sökväg till filen</h2>
<p>Ett alternativ är att ange den absoluta sökvägen till filen, dvs exakt var den ligger på din hårddisk, det är en bra metod att använda sig av för att alltid veta vilken fil man arbetar med och är fördelaktig om man arbetar med filer som är spridda i olika mappar på din dator. Det är oklokt att ändra Working Directory under en pågående analys, och det är också oklokt att ha mer än en kopia av samma fil på din hårddisk. För att undvika det kan man använda absoluta sökvägar.</p>
<p><strong>Fördel</strong></p>
<ul>
<li>Ger en absolut sökväg (du hittar alltid vilken fil du arbetar med)</li>
</ul>
<p><strong>Nackdel</strong></p>
<ul>
<li>Att få reda på den absoluta sökvägen kan vara lite omständigt (men behöver bara göras en gång per dataset)</li>
</ul>
<section id="ta-reda-på-den-absoluta-sökvägen-till-din-fil-med-data" class="level3">
<h3 class="anchored" data-anchor-id="ta-reda-på-den-absoluta-sökvägen-till-din-fil-med-data">Ta reda på den absoluta sökvägen till din fil med data</h3>
<p>Ladda ner filen <a href="data/testdata.txt">testdata.txt</a> (högerklicka, välj “spara länk som”) och spara filen på din hårddisk <strong>i en annan mapp</strong> än där du sparade filen i förra exemplet.</p>
<p>Nästa steg är att tala om för R var på din hårddisk du har sparat filen (den absoluta sökvägen till filen).</p>
<p>Det enklaste sättet att få reda på den absoluta sökvägen är att öpna din <strong>filhanterare</strong> (finder, utforskaren eller liknande) och leta upp filen. Sedan <strong>drar du filen och släpper den i R-konsolen</strong>. Då kommer du få se dess sökväg, vilket visas i <strong>blått</strong> på en Mac (samt ev felmeddelanden eftersom du gör något som R inte förstår, men R ger dig sökvägen, vilket är vad vi vill ha).</p>
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><img src="images/absolute-path-R.png" class="img-fluid quarto-figure quarto-figure-left figure-img" width="600"></p>
</figure>
</div>
<p>Sökvägen till filen på min dator är: <code>~/git_projects/Introduktion-till-R/tutorials/read-data/data/testdata.txt</code></p>
<p><strong>R Studio</strong> - om du använder R studio fungerar det inte att dra filen till konsolen. Istället kan du öppna din terminal (Terminal, iTerm, EMAC, MobaXterm etc) och släppa filen där. Eller gör det i vanliga R. Då får du en sökväg.</p>
<div class="quarto-figure quarto-figure-left">
<figure class="figure">
<p><img src="images/absolute-path-terminal.png" class="img-fluid figure-img" width="600"></p>
<figcaption>Sökväg till filen om man släpper den i en terminal (iTerm i exemplet)</figcaption>
</figure>
</div>
</section>
<section id="läs-in-filen-i-r" class="level3" data-link="Läs in filen i R">
<h3 data-link="Läs in filen i R" class="anchored" data-anchor-id="läs-in-filen-i-r">Läs in filen i R</h3>
<p>Vi kommer åter att läsa in filen med funktionen <code>read.table()</code>.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>testdata <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">"data/testdata.txt"</span>,</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">header=</span>T,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">sep=</span><span class="st">"</span><span class="sc">\t</span><span class="st">"</span>,</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">dec=</span><span class="st">","</span>) </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>Notera att vi nu har en längre sökväg till filen.</p>
<p><code>"data/testdata.txt"</code> är sökvägen till datafilen, dvs där den är sparad på din hårddisk (<code>data/</code>), och namnet på filen (<code>testdata.txt</code>).</p>
<p>Se <a href="#läs-in-filen-i-r">Läs in filen i R</a> för vår tidigare beskrivning av hur man tolkar de olika delarna av funktionen <code>read.table()</code>. Efter att du läst in filen skall du alltid <a href="#inspektera-ditt-data">Inspektera ditt data</a> innan du börjar med dina analyser.</p>
</section>
</section>
<section id="dataformat" class="level2">
<h2 class="anchored" data-anchor-id="dataformat">Dataformat</h2>
<p>R kan hantera ett stort antal dataformat, vissa av dem läses automatiskt, andra kräver att man laddar ner och installerar specialiserade paket.</p>
<table class="caption-top table">
<caption>Vanliga datatyper som R kan läsa in (många fler alternativ finns)</caption>
<thead>
<tr class="header">
<th>Filändelse</th>
<th>Beskrivning</th>
<th>Funktion</th>
<th>Extra paket krävs</th>
<th>Kommentarer</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>txt</code></td>
<td>Tab-avgränsad text</td>
<td><code>read.table()</code></td>
<td>-</td>
<td></td>
</tr>
<tr class="even">
<td><code>csv</code></td>
<td>Komma/semikolon-avgränsad text</td>
<td><code>read.csv()</code></td>
<td>-</td>
<td>Specificera om avgränsningen är “,” eller “;”</td>
</tr>
<tr class="odd">
<td><code>xlsx</code></td>
<td>Exceldokument</td>
<td><code>read.xlsx()</code></td>
<td><code>openxlsx</code></td>
<td><a href="https://cran.r-project.org/web/packages/openxlsx/readme/README.html">Se paketets dokumentation</a></td>
</tr>
<tr class="even">
<td><code>rda</code></td>
<td>R-datafil</td>
<td><code>load()</code></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td><code>sas7bdat</code> <code>sas7bcat</code> <code>dta</code> <code>sav</code></td>
<td>SAS<br>
Stata<br>
SPSS</td>
<td><code>read_sas()</code><br>
<code>read_dta()</code><br>
<code>read_sav()</code></td>
<td><code>haven</code></td>
<td><a href="https://haven.tidyverse.org/">Se paketets dokumentation</a></td>
</tr>
</tbody>
</table>
<p>Vi har redan testat att läsa in en tab-avgänsad textfil. Nu skall vi testa på några andra filtyper.</p>
</section>
<section id="läsa-in-csv-fil" class="level2">
<h2 class="anchored" data-anchor-id="läsa-in-csv-fil">Läsa in csv-fil</h2>
<p>En csv-fil är en fil där värderna är avgränsade av komma eller semikolon. Det är en mycket vanlig filtyp att långtidslagra data i.</p>
<p>Ladda ner filen <a href="data/testdata_csv.csv">testdata_csv.csv</a> och spara den någonstans på din hårddisk.</p>
<p>Efter det letar du upp filen, antingen genom att använda <a href="#relativ-sökväg-till-filen">Relativ sökväg till filen</a> eller <a href="#absolut-sökväg-till-filen">Absolut sökväg till filen</a>. Om du sparat den i samma mapp som du har din Working Directory är det enkelt att använda en relativ sökväg.</p>
<section id="läs-in-filen-1" class="level3">
<h3 class="anchored" data-anchor-id="läs-in-filen-1">Läs in filen</h3>
<p>Vi kommer åter att läsa in filen med funktionen <code>read.csv()</code>. Fyll i korrekt sökväg till din fil</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>testdata_csv <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"data/testdata_csv.csv"</span>,</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">header=</span>T,</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">sep=</span><span class="st">";"</span>,</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">dec=</span><span class="st">","</span>) </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>Vi sparar resultatet från funktionen <code>read.csv()</code>, vilket är ett dataset, med namnet <code>testdata_csv</code>. Man skall alltid använda olika namn för olika dataset.</p>
<p><code>sep=";"</code> betyder att värderna i filen är separerade av semikolon. I övrigt påminner funktionen om <code>read.table()</code> som beskrivits i detalj ovan (<a href="#läs-in-filen">Läs in filen</a>). Efter att du läst in filen skall du alltid <a href="#inspektera-ditt-data">Inspektera ditt data</a> innan du börjar med dina analyser.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(testdata_csv)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   10 obs. of  3 variables:
 $ Colour: chr  "Red" "Red" "Red" "Red" ...
 $ Weight: int  7 4 3 4 5 12 14 15 11 14
 $ Length: num  2.3 4.1 3.4 2.5 7.1 14.5 16.9 13.5 9.4 11</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(testdata_csv)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  Colour Weight Length
1    Red      7    2.3
2    Red      4    4.1
3    Red      3    3.4
4    Red      4    2.5
5    Red      5    7.1
6  White     12   14.5</code></pre>
</div>
</div>
</section>
</section>
<section id="läsa-in-excelfil" class="level2">
<h2 class="anchored" data-anchor-id="läsa-in-excelfil">Läsa in Excelfil</h2>
<p>De flesta som samlar in biologiska data skriver in sina värden i Excel, och exporterar sedan sina data som en <code>*.txt</code>eller `<em>.csv</em> fil. Det kan därför vara lockande att direkt läsa in sina excelblad i R, utan att gå omvägen via export till ett annat format.</p>
<p><strong>Fördelar med att direkt läsa in excelfiler</strong></p>
<ul>
<li>Du har bara en enda fil med data, det är ingen risk att du lägger in nya data i Excel men glömmer att exportera det som txt eller csv-fil</li>
</ul>
<p><strong>Nackdelar med att direkt läsa in excelfiler</strong></p>
<ul>
<li><p>Excel har ett propriärt format, det är inte säkert att dina filer kan läsas i framtiden, därmed bättre att spara dina data i ett öppet format som txt eller csv</p></li>
<li><p>Det är bra att separera sina excelfiler (där pågående datainsamling skrivs in) från ditt färdiga data (din txt eller csv-fil) som inte skall manipuleras.</p></li>
</ul>
<p>Ladda ner filen <a href="data/testdata_excel.xlsx">testdata_excel.xlsx</a> och spara den någonstans på din hårddisk.</p>
<p>Efter det letar du upp filen, antingen genom att använda <a href="#relativ-sökväg-till-filen">Relativ sökväg till filen</a> eller <a href="#absolut-sökväg-till-filen">Absolut sökväg till filen</a>. Om du sparat den i samma mapp som du har din Working Directory är det enkelt att använda en relativ sökväg.</p>
<section id="läsa-in-excelfilen" class="level3">
<h3 class="anchored" data-anchor-id="läsa-in-excelfilen">Läsa in Excelfilen</h3>
<p>För att kunna läsa in en Excelfil behöver vi installera paketet <code>openxlsx</code>. Se den tidigare informationen i kapitlet om att <a href="https://martin-lind.github.io/Introduktion-till-R/tutorials/R-packages/">installera paket</a> för en fullständig genomgång om hur man hanterar paket.</p>
<p>Du installerar paketet med koden ìnstall.packages(“openxlsx”)`</p>
<p>När paketet är installerat behöver vi läsa in det i vår pågående session i R</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(openxlsx)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p>Nu är paketet inläst och vi kan använda oss av funktionen <code>read.xlsx()</code> för att läsa in vår Excelfil.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>testdata_excel <span class="ot">&lt;-</span> <span class="fu">read.xlsx</span>(<span class="st">"data/testdata_excel.xlsx"</span>,</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">sheet=</span><span class="dv">1</span>) </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
</div>
<p><code>sheet=1</code> betyder att du läser in det första bladet i Exceldokumentet.</p>
<p>Efter att du läst in filen skall du alltid <a href="#inspektera-ditt-data">Inspektera ditt data</a> innan du börjar med dina analyser.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(testdata_excel)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   10 obs. of  3 variables:
 $ Colour: chr  "Purple" "Purple" "Purple" "Purple" ...
 $ Mass  : num  2 5 3 5 5 12 14 15 11 14
 $ Width : num  12.3 14.1 12.4 12.5 17.1 20.5 26.9 23.5 19.4 21</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(testdata_excel)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  Colour Mass Width
1 Purple    2  12.3
2 Purple    5  14.1
3 Purple    3  12.4
4 Purple    5  12.5
5 Purple    5  17.1
6 Yellow   12  20.5</code></pre>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>